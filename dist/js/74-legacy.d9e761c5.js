"use strict";(self["webpackChunkfront_end_do_an"]=self["webpackChunkfront_end_do_an"]||[]).push([[74],{5074:function(t,n,e){e.r(n),e.d(n,{default:function(){return C}});var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("div",{staticClass:"container"},[t._m(0),e("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.billIndex,callback:function(n){t.billIndex=n},expression:"billIndex"}},[e("el-tab-pane",{attrs:{label:"Tất cả"}},[0==t.billIndex?e("div",[e("BillDetail",{attrs:{billIndex:t.billIndex}})],1):t._e()]),e("el-tab-pane",{attrs:{label:"Chờ xác nhận"}},[1==t.billIndex?e("div",[e("BillDetail",{attrs:{billIndex:t.billIndex}})],1):t._e()]),e("el-tab-pane",{attrs:{label:"Chờ đóng hàng"}},[2==t.billIndex?e("div",[e("BillDetail",{attrs:{billIndex:t.billIndex}})],1):t._e()]),e("el-tab-pane",{attrs:{label:"Đang chuyển hàng"}},[3==t.billIndex?e("div",[e("BillDetail",{attrs:{billIndex:t.billIndex}})],1):t._e()]),e("el-tab-pane",{attrs:{label:"Đang giao"}},[4==t.billIndex?e("div",[e("BillDetail",{attrs:{billIndex:t.billIndex}})],1):t._e()]),e("el-tab-pane",{attrs:{label:"Thành công"}},[5==t.billIndex?e("div",[e("BillDetail",{attrs:{billIndex:t.billIndex}})],1):t._e()]),e("el-tab-pane",{attrs:{label:"Đã hủy"}},[6==t.billIndex?e("div",[e("BillDetail",{attrs:{billIndex:t.billIndex}})],1):t._e()])],1)],1)])},a=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("h4",{staticClass:"text-center"},[t._v("Thông tin đơn hàng")])])}],l=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[t.listBill.length>0?e("div",[t._l(t.listBill,(function(n){return e("div",{key:n.id},[e("div",{staticClass:"container"},[e("div",{staticClass:"bill-detail"},[e("div",{staticClass:"header-bill-detail"}),e("div",{staticClass:"content-bill-detail"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 product mb-5"},[e("div",{staticClass:"d-flex justify-content-between mt-2 mb-2"},[e("div",{staticClass:"totalMoney d-flex"},[e("label",[t._v("Mã đơn hàng :")]),e("span",[t._v(" "+t._s(n.billCode))])]),e("div",{domProps:{innerHTML:t._s(t.checkStatus(n.status))}})]),e("div",[e("table",{staticClass:"table table secondary-5:border text-center"},[e("tbody",t._l(n.listDetail,(function(i,a){return e("tr",{key:i.id},[e("td",[t._v(t._s(a+1))]),e("td",{staticClass:"d-flex justify-content-center"},[e("div",[e("img",{staticClass:"product-img",attrs:{src:i.img,alt:""}})]),e("div",{staticClass:"product-name"},[e("div",{staticClass:"text-sm-left"},[t._v(" "+t._s(i.productName)+" ")]),e("div",{staticClass:"d-flex"},t._l(i.speciality,(function(n){return e("div",{key:n.id},[e("div",[e("button",{staticClass:"product-speciality"},[t._v(" "+t._s(n.description)+" ")])])])})),0)])]),e("td",[t._v(t._s(t.toMoney(i.priceSell)))]),e("td",[t._v("x"+t._s(i.quantity))]),e("td",{attrs:{id:"total"+i.id}},[t._v(" "+t._s(t.toMoney(i.totalPrice))+" ")]),e("td",[5==n.status&&0==i.review?e("button",{staticClass:"btn btn-outline-dark mr-3",attrs:{type:"button"},on:{click:function(e){return t.reviewProduct(n.billId,i.productId,i)}}},[t._v(" Đánh giá ")]):t._e(),5==n.status&&1==i.review?e("button",{staticClass:"btn btn-success mr-3",attrs:{type:"button",disabled:""}},[t._v(" Đã đánh giá ")]):t._e()])])})),0)])]),e("div",{staticClass:"footer-bill-detail"},[e("div",{staticClass:"totalMoney d-flex justify-content-between"},[e("div",[e("div",[e("label",[t._v("Ngày đặt :")]),e("span",[t._v(" "+t._s(t.formatDate(n.billDate)))])]),e("div",[e("label",[t._v("Ngày nhận :")]),e("span",[t._v(" "+t._s(t.formatDate(n.deliveryTime)))])])]),e("div",[e("div",{staticClass:"d-flex"},[e("label",[t._v("Tổng tiền")]),e("span",[t._v(": "+t._s(t.toMoney(n.totalPrice+n.ship)))])])])]),e("div",{staticClass:"totalMoney d-flex justify-content-end mt-2 mb-2"},[1==n.status?e("button",{staticClass:"btn btn-danger mr-3",attrs:{type:"button"},on:{click:function(e){return t.cancelBill(n)}}},[t._v(" Hủy ")]):t._e(),5==n.status?e("button",{staticClass:"btn btn-danger mr-3",attrs:{type:"button"}},[t._v(" Hóa đơn ")]):t._e(),e("button",{staticClass:"btn btn-outline-secondary mr-3",attrs:{type:"button"}},[t._v(" Liên hệ với cửa hàng ")]),5==n.status?e("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"}},[t._v(" Mua lại ")]):t._e()])])])])]),e("div",{staticClass:"footer-bill-detail"})])]),e("hr")])})),e("div",{staticStyle:{width:"100%","text-align":"center"}},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.totalPage,"page-size":1},on:{"current-change":t.handleCurrentChange}})],1)],2):t._e(),t.listBill.length<=0?e("div",[t._m(0)]):t._e(),e("el-dialog",{attrs:{top:"24vh",title:"Đánh giá sản phẩm",visible:t.dialogFormVisible,width:"60%",height:"100vh"},on:{"update:visible":function(n){t.dialogFormVisible=n}}},[e("div",{staticClass:"container"},[e("form",{staticClass:"row",attrs:{id:"review-product"},on:{submit:function(n){return n.preventDefault(),t.callReviewProduct.apply(null,arguments)}}},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"block"},[e("span",{staticClass:"demonstration"}),e("el-rate",{model:{value:t.comment.stars,callback:function(n){t.$set(t.comment,"stars",n)},expression:"comment.stars"}}),t.submitted&&0==t.comment.stars?e("div",{staticClass:"error"},[t._v(" Vui lòng đánh giá sao ")]):t._e()],1)]),e("div",{staticClass:"form-group col-6"},[e("label",{attrs:{for:""}},[t._v("Tiêu đề")]),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.$v.comment.title.$model,expression:"$v.comment.title.$model",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"Vui lòng nhập tiêu đề"},domProps:{value:t.$v.comment.title.$model},on:{input:function(n){n.target.composing||t.$set(t.$v.comment.title,"$model",n.target.value.trim())},blur:function(n){return t.$forceUpdate()}}}),t.submitted&&!t.$v.comment.title.required?e("div",{staticClass:"error"},[t._v(" Tiêu đề không thể để trống ")]):t._e(),t.$v.comment.title.maxLength?t._e():e("div",{staticClass:"error"},[t._v(" Tiều đề không quá "+t._s(t.$v.comment.title.$params.maxLength.max)+" kí tự. ")])]),e("div",{staticClass:"form-group col-12"},[e("label",{attrs:{for:""}},[t._v("Nội dung")]),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.$v.comment.content.$model,expression:"$v.comment.content.$model",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{rows:"5"},domProps:{value:t.$v.comment.content.$model},on:{input:function(n){n.target.composing||t.$set(t.$v.comment.content,"$model",n.target.value.trim())},blur:function(n){return t.$forceUpdate()}}}),t.submitted&&!t.$v.comment.content.required?e("div",{staticClass:"error"},[t._v(" Nội dung không thể để trống ")]):t._e(),t.$v.comment.content.maxLength?t._e():e("div",{staticClass:"error"},[t._v(" Nội dung không quá "+t._s(t.$v.comment.content.$params.maxLength.max)+" kí tự. ")])])])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("button",{staticClass:"btn btn-outline-primary",attrs:{type:"submit",form:"review-product"}},[t._v(" Áp dụng ")]),e("button",{staticClass:"btn btn-outline-primary ml-2",on:{click:t.cancelModalReview}},[t._v(" Quay lại ")])])])],1)},o=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"text-center"},[e("img",{attrs:{src:"https://firebasestorage.googleapis.com/v0/b/san-ho-do-an-dai-duong.appspot.com/o/banner%2F5fafbb923393b712b96488590b8f781f.png?alt=media",alt:"",srcset:""}}),e("h5",[t._v("Chưa có đơn hàng")])])}],s=(e(38862),e(32424)),c=e(6409),r=e(69409),u=e(17133),d=e.n(u),m={mixins:[s.oE],props:["billIndex"],name:"BillDetalView",data:function(){return{listBill:[],totalPage:1,dialogFormVisible:!1,comment:{billId:"",productId:"",title:"",content:"",stars:0},submitted:!1,product:{}}},validations:{comment:{title:{required:c.C1,maxLength:(0,c.BS)(100)},content:{required:c.C1,maxLength:(0,c.BS)(3e3)},stars:{required:c.C1}}},components:{},created:function(){var t=this;this.getAllBill(1),(0,r.Ne)(this.billIndex).then((function(n){t.totalPage=n}))},methods:{getAllBill:function(t){var n=this;(0,r.cR)(this.billIndex,t).then((function(t){n.listBill=t})).catch((function(t){console.log(t)}))},handleCurrentChange:function(t){this.getAllBill(t),window.scrollTo(0,0)},toMoney:function(t){var n=new Intl.NumberFormat("it-IT",{style:"currency",currency:"VND"});return n.format(t)},formatDate:function(t){if(null==t)return"Chưa nhận";var n=d()(String(t)).format("MM/DD/YYYY HH:mm:ss");return n},checkStatus:function(t){return-2==t?'<button type="button" class="btn btn-danger">Hủy</button>':1==t?'<button type="button" class="btn btn-warning">Đang xác nhận</button>':2==t?'<button type="button" class="btn btn-info">Đang đóng hàng</button>':3==t?'<button type="button" class="btn btn-secondary">Đang chuyển hàng</button>':4==t?'<button type="button" class="btn btn-dark">Đang giao hàng</button>':5==t?'<button type="button" class="btn btn-success">Thành công</button>':void 0},checkStatusText:function(t){return-2==t?"Hủy":1==t?"Đang xác nhận":2==t?"Đang đóng hàng":3==t?"Đang chuyển hàng":4==t?"Đang giao hàng":5==t?"Thành công":void 0},cancelBill:function(t){this.$swal({title:"Bạn có chắc chắn Muốn Hủy ?",text:"Đơn đặt hàng có mã: ".concat(t.billCode),type:"question",icon:"question",showCancelButton:!0,confirmButtonText:"Đồng ý",cancelButtonText:"Quay lại",closeOnConfirm:!1,closeOnCancel:!1}).then((function(n){n.isConfirmed&&(t.status=-2,t.checkBill=!1,(0,r.zA)(t.billId).then((function(n){t.staffId=n.data})).catch((function(t){console.log(t)})))}))},reviewProduct:function(t,n,e){this.product=e,console.log(this.product.productName),this.comment={billId:"",productId:"",title:"",content:"",stars:0},this.dialogFormVisible=!0,this.comment.productId=n,this.comment.billId=t},callReviewProduct:function(t){var n=this;if(t.preventDefault(),this.submitted=!0,this.$v.$touch(),this.$v.$invalid||0==this.comment.stars)console.log("error validate");else{var e=JSON.stringify(this.comment);(0,r.XE)(e).then((function(t){n.product.review=1,n.cancelModalReview(),n.$swal(t,"Cảm ơn quý khách đã đánh giá sản phẩm của cửa hàng","success")})).catch((function(t){console.log(t)}))}},cancelModalReview:function(){this.dialogFormVisible=!1,this.product={},this.submitted=!1,this.comment={billId:"",productId:"",title:"",content:"",stars:0}}},mounted:function(){}},b=m,v=e(43736),h=(0,v.Z)(b,l,o,!1,null,"64ef59fc",null),f=h.exports,p={components:{BillDetail:f},name:"BillView",data:function(){return{billIndex:0,ListBill:[]}},created:function(){},methods:{handleClick:function(){console.log(this.billIndex)},getAllBill:function(){}},mounted:function(){}},g=p,_=(0,v.Z)(g,i,a,!1,null,"1f0d6b1a",null),C=_.exports},69409:function(t,n,e){e.d(n,{Ne:function(){return c},PZ:function(){return u},Wx:function(){return m},XE:function(){return d},cR:function(){return s},p7:function(){return o},ul:function(){return b},zA:function(){return r}});e(41539);var i=e(31223),a=e(26166),l=(0,i.X)();function o(t){return new Promise((function(n,e){var i={method:"post",url:l+"/api/v3/user/bill",headers:{"Content-Type":"application/json"},data:t};a(i).then((function(t){n(t.data.data)})).catch((function(t){e(t)}))}))}function s(t,n){return new Promise((function(e,i){var o={method:"get",url:l+"/api/v3/user/bill/status/"+t+"/?page="+n,headers:{"Content-Type":"application/json"}};a(o).then((function(t){e(t.data.data)})).catch((function(t){i(t)}))}))}function c(t){return new Promise((function(n,e){var i={method:"get",url:l+"/api/v3/user/bill/total/"+t,headers:{"Content-Type":"application/json"}};a(i).then((function(t){n(t.data.data)})).catch((function(t){e(t)}))}))}function r(t){return new Promise((function(n,e){var i={method:"put",url:l+"/api/v3/user/bill/cancel/"+t,headers:{"Content-Type":"application/json"}};a(i).then((function(t){n(t.data)})).catch((function(t){console.log(t),e(t)}))}))}function u(t){return new Promise((function(n,e){var i={method:"get",url:l+"/api/v3/user/bill/detail/"+t,headers:{"Content-Type":"application/json"}};a(i).then((function(t){n(t.data.data)})).catch((function(t){e(t)}))}))}function d(t){return new Promise((function(n,e){var i={method:"post",url:l+"/api/v3/user/comment/review",headers:{"Content-Type":"application/json"},data:t};a(i).then((function(t){n(t.data.data)})).catch((function(t){e(t)}))}))}function m(t){return new Promise((function(n,e){var i={method:"get",url:l+"/api/v3/user/bill/pay-now"+t,headers:{"Content-Type":"application/json"}};a(i).then((function(t){n(t.data.data)})).catch((function(t){e(t)}))}))}function b(t){return new Promise((function(n,e){var i={method:"post",url:l+"/api/v3/user/bill/pay-now",headers:{"Content-Type":"application/json"},data:t};a(i).then((function(t){n(t.data.data)})).catch((function(t){e(t)}))}))}}}]);
//# sourceMappingURL=74-legacy.d9e761c5.js.map