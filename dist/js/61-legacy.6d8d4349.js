"use strict";(self["webpackChunkfront_end_do_an"]=self["webpackChunkfront_end_do_an"]||[]).push([[61],{12061:function(t,e,n){n.r(e),n.d(e,{default:function(){return x}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._m(0),n("div",{staticClass:"between:flex bottom:margin-3"},[n("div",{staticClass:"center:flex-items"},[n("span",{staticClass:"right:margin-1"},[t._v("Hiển thị")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.currentEntries,expression:"currentEntries"}],staticClass:"select",staticStyle:{width:"5rem"},on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.currentEntries=e.target.multiple?n:n[0]},t.paginateEntries]}},t._l(t.showEntries,(function(e){return n("option",{key:e,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0),n("span",{staticClass:"left:margin-1"},[t._v("mục")])]),n("div",{staticClass:"end:flex"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"input px:width-25",attrs:{type:"search",placeholder:"Tìm kiếm tại đấy..."},domProps:{value:t.searchInput},on:{keyup:t.searchEvent,input:function(e){e.target.composing||(t.searchInput=e.target.value)}}})])]),n("div",[n("table",{staticClass:"table table:border secondary-5:border text-center"},[n("thead",[n("tr",t._l(t.tableHeader,(function(e){return n("th",{key:e.name},[n("div",{staticClass:"between:flex center:items"},[n("span",[t._v(t._s(e.text))]),n("span",{on:{click:function(n){return n.preventDefault(),t.sortByColumn(e.name)}}},[null==t.check?n("div",[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-sort"}})],1):t._e(),0==t.check?n("div",[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-sort-down"}})],1):t._e(),t.check?n("div",[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-sort-up"}})],1):t._e()])])])})),0),n("tr",[n("td"),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.col.code,expression:"col.code"}],staticClass:"input",attrs:{type:"search",placeholder:"Lọc mã hóa đơn...."},domProps:{value:t.col.code},on:{keyup:t.filterByColumn,input:function(e){e.target.composing||t.$set(t.col,"code",e.target.value)}}})]),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.col.userId,expression:"col.userId"}],staticClass:"select",attrs:{name:"",id:""},on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.col,"userId",e.target.multiple?n:n[0])},t.filterByColumn]}},[n("option",{attrs:{value:""}},[t._v("--Lọc Khách hàng --")]),t._l(t.uniqColumData("userId"),(function(e){return n("option",{key:e,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])}))],2)]),n("td"),n("td"),n("td"),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.col.staffId,expression:"col.staffId"}],staticClass:"select",attrs:{name:"",id:""},on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.col,"staffId",e.target.multiple?n:n[0])},t.filterByColumn]}},[n("option",{attrs:{value:""}},[t._v("--Lọc nhà nhân viên --")]),t._l(t.uniqColumData("staffId"),(function(e){return n("option",{key:e,domProps:{value:""==e?" ":e}},[""!=e?n("div",[t._v(" "+t._s(e))]):t._e(),""==e?n("div",[t._v("Đang chờ xác minh")]):t._e()])}))],2)]),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.col.status,expression:"col.status"}],staticClass:"select",attrs:{name:"",id:""},on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.col,"status",e.target.multiple?n:n[0])},t.filterByColumn]}},[n("option",{attrs:{value:""}},[t._v("--Lọc trạng thái --")]),t._l(t.uniqColumData("status"),(function(e){return n("option",{key:e,domProps:{value:e}},[1==e?n("div",[t._v("Đang xác nhận")]):t._e(),-2==e?n("div",[t._v("Hủy")]):t._e(),2==e?n("div",[t._v("Đang đóng hàng")]):t._e(),3==e?n("div",[t._v("Đang chuyển hàng")]):t._e(),4==e?n("div",[t._v("Đang giao hàng")]):t._e(),5==e?n("div",[t._v("Thành công")]):t._e()])}))],2)]),n("td")])]),n("tbody",t._l(t.tableData,(function(e,a){return n("tr",{key:e.id},[n("td",[t._v(t._s(a+1))]),n("td",[t._v(t._s(e.code))]),n("td",[t._v(t._s(e.userId))]),n("td",{staticStyle:{width:"15%"}},[t._v(t._s(t.formatDate(e.billDate)))]),n("td",{staticStyle:{width:"15%"}},[t._v(t._s(t.formatDate(e.deliveryTime)))]),n("td",[t._v(t._s(t.toMoney(e.totalPrice)))]),n("td",[e.checkBill?t._e():[t._v(" "+t._s(e.staffId)+" ")],e.checkBill?[t._v(" Đang chờ xác minh ")]:t._e()],2),e.checkBill?t._e():n("td",{staticStyle:{width:"15%"},domProps:{innerHTML:t._s(t.checkStatus(e.status))},on:{click:function(n){return t.updateStatus(e)}}}),e.checkBill?n("td",[n("button",{staticClass:"btn btn-warning",attrs:{type:"button",id:"btn-choose-user-manu"+e.id},on:{click:function(n){return t.ConfirmBill(e)}}},[t._v(" Xác minh ")]),n("button",{staticClass:"btn btn-danger ml-1",attrs:{type:"button",id:"btn-choose-user-manu"+e.id},on:{click:function(n){return t.CancelBill(e)}}},[t._v(" Hủy ")])]):t._e(),n("td",[n("div",{staticClass:"action"},[n("div",{staticClass:"button-show-modal m-product-cart-button-clear",attrs:{id:"one"}},[n("button",{staticClass:"clear-test",attrs:{type:"button",id:"m-into-choose-product"},on:{click:function(n){return t.openModal(e.id)}}},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-plus"}})],1)]),-2!=e.status&&5!=e.status&&1!=e.status?n("div",{staticClass:"m-product-cart-button-clear"},[n("button",{staticClass:"clear-test",attrs:{type:"button",id:"m-into-choose-product"},on:{click:function(n){return t.cancelReceipt(e)}}},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-xmark"}})],1)]):t._e(),5==e.status?n("div",{staticClass:"m-product-cart-button-clear"},[n("button",{staticClass:"clear-test",attrs:{type:"button",id:"m-into-choose-product"},on:{click:function(n){return t.exportpdf(e)}}},[n("font-awesome-icon",{attrs:{icon:"fas fa-download"}})],1)]):t._e()])])])})),0)])]),n("div",{staticClass:"between:flex y:margin-3"},[n("div",[t._v(" Hiển thị từ "+t._s(t.showInfo.from)+" đến "+t._s(t.showInfo.to)+" / "+t._s(t.showInfo.of)+" ")]),n("div",{staticClass:"end:flex"},[n("ul",{staticClass:"pagination:nav"},[n("li",{class:["nav-item",{disabled:1===t.currentPage}]},[n("a",{staticClass:"nav-link",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.currentPage=1,t.paginateEntries()}}},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-angles-left"}})],1)]),n("li",{class:["nav-item",{disabled:1===t.currentPage}]},[n("a",{staticClass:"nav-link",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.currentPage<1?t.currentPage=1:t.currentPage-=1,t.paginateEntries()}}},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-angle-left"}})],1)]),t._l(t.showPagination,(function(e){return n("li",{key:e,class:["nav-item",{ellipsis:"..."===e,active:e===t.currentPage}]},[n("a",{staticClass:"nav-link",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.paginateEvent(e)}}},[t._v(t._s(e))])])})),n("li",{class:["nav-item",{disabled:t.currentPage===t.allPages}]},[n("a",{staticClass:"nav-link",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.currentPage>t.allPages?t.currentPage=t.allPages:t.currentPage+=1,t.paginateEntries()}}},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-angle-right"}})],1)]),n("li",{class:["nav-item",{disabled:t.currentPage===t.allPages}]},[n("a",{staticClass:"nav-link",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.currentPage=t.allPages,t.paginateEntries()}}},[n("font-awesome-icon",{attrs:{icon:"fa-solid fa-angles-right"}})],1)])],2)])]),n("div",{staticStyle:{"z-index":"2700"},attrs:{id:"modal-container"}},[n("div",{staticClass:"modal-background"},[n("div",{staticClass:"modal",staticStyle:{width:"60%",height:"100vh"}},[n("div",{staticClass:"table-wrapper-scroll-modal-y my-custom-scrollbar-modal p-5"},[t._m(1),n("hr"),n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"row",attrs:{id:"receipt-detail"}},[n("div",{staticClass:"col-6 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Mã hoá đơn:")]),n("div",[t._v(t._s(t.getBillDetail.billCode))])]),n("div",{staticClass:"col-6 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Tên khách hàng:")]),n("div",[t._v(t._s(t.getBillDetail.fullName))])]),n("div",{staticClass:"col-6 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Email:")]),n("div",[t._v(t._s(t.getBillDetail.email))])]),n("div",{staticClass:"col-6 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Số điện thoại:")]),n("div",[t._v(t._s(t.getBillDetail.phone))])]),n("div",{staticClass:"col-12 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Địa chỉ:")]),n("div",[t._v(t._s(t.getBillDetail.address))])]),n("div",{staticClass:"col-6 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Ngày đặt:")]),n("div",[t._v(t._s(t.formatDate(t.getBillDetail.billDate)))])]),n("div",{staticClass:"col-6 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Ngày Nhận:")]),n("div",[t._v(t._s(t.formatDate(t.getBillDetail.deliveryTime)))])]),n("div",{staticClass:"col-6 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Tổng giá:")]),n("div",[t._v(t._s(t.toMoney(t.getBillDetail.totalPrice)))])]),n("div",{staticClass:"col-6 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Nhà nhân viên:")]),n("div",[t._v(t._s(t.getBillDetail.staffName))])]),n("div",{staticClass:"col-6 d-flex mb-3"},[n("div",{domProps:{innerHTML:t._s(t.checkStatus(t.getBillDetail.status))}})]),n("div",{staticClass:"col-12 d-flex mb-3"},[n("div",{staticClass:"font-weight-bold mr-2"},[t._v("Ghi chú:")]),n("div",[t._v(t._s(t.getBillDetail.note))])])])]),n("div",{staticClass:"m-product-cart-context table-wrapper-scroll-y my-custom-scrollbar"},[n("h4",{staticClass:"font-weight-bold"},[t._v("Danh sách sản phẩm")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.getBillDetail.listDetail,border:"",height:"30vh"}},[n("el-table-column",{attrs:{prop:"productCode",label:"Mã sản phẩm"}}),n("el-table-column",{attrs:{prop:"productName",label:"Tên sản phẩm"}}),n("el-table-column",{attrs:{prop:"priceSell",label:"Giá nhập"}}),n("el-table-column",{attrs:{prop:"quantity",label:"Số lượng"}}),n("el-table-column",{attrs:{prop:"totalPrice",label:"Tổng"}})],1)],1)])])])])])},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"product-header"},[n("h1",[t._v("Danh sách đơn đặt hàng")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"text-center mt-2 header-modal-customer"},[n("h2",{staticClass:"font-weight-bold"},[t._v("Chi tiết hoá đơn")]),n("div",{staticClass:"button-show-modal-out"},[n("i",{staticClass:"fas fa-times"})])])}],s=(n(41539),n(33948),n(74916),n(64765),n(69720),n(54747),n(92222),n(78783),n(60285),n(41637),n(75587)),o=n(17133),c=n.n(o),l=n(31223),r=n(26166),u=(0,l.X)();function d(){return new Promise((function(t,e){var n={method:"get",url:u+"/api/v1/admin/bill",headers:{"Content-Type":"application/json"}};r(n).then((function(e){t(e.data.data)})).catch((function(t){e(t)}))}))}function h(t){return new Promise((function(e,n){var a={method:"get",url:u+"/api/v1/admin/bill/"+t,headers:{"Content-Type":"application/json"}};r(a).then((function(t){e(t.data.data)})).catch((function(t){console.log(t),n(t)}))}))}function f(t){return new Promise((function(e,n){var a={method:"put",url:u+"/api/v1/admin/bill/verify/"+t,headers:{"Content-Type":"application/json"}};r(a).then((function(t){e(t.data.data)})).catch((function(t){console.log(t),n(t)}))}))}function m(t){return new Promise((function(e,n){var a={method:"put",url:u+"/api/v1/admin/bill/cancel/"+t,headers:{"Content-Type":"application/json"}};r(a).then((function(t){e(t.data)})).catch((function(t){console.log(t),n(t)}))}))}function v(t){return new Promise((function(e,n){var a={method:"put",url:u+"/api/v1/admin/bill/status/"+t,headers:{"Content-Type":"application/json"}};r(a).then((function(t){e(t.data)})).catch((function(t){console.log(t),n(t)}))}))}function p(t){return new Promise((function(e,n){var a={method:"get",url:u+"/api/v1/admin/bill/export/pdf/"+t,headers:{"Content-Type":"application/json"},responseType:"blob"};r(a).then((function(t){e(t)})).catch((function(t){console.log(t),n("Wrong email or password")}))}))}var g=n(74029),b=n.n(g),_={name:"AdminProduct",components:{},data:function(){return{columns:[{name:"id",text:"ID"},{name:"code",text:"Mã hóa đơn"},{name:"userId",text:"Khách hàng"},{name:"receiptDate",text:"Ngày đặt"},{name:"receivedDate",text:"Ngày nhận"},{name:"totalPrice",text:"Tổng tiền"},{name:"staffId",text:"Nhân viên"},{name:"status",text:"Trạng thái"},{name:"#",text:"Hành động"}],entries:[],showEntries:[5,10,15,25,50,72,100],currentEntries:10,filteredEntries:[],currentPage:1,allPages:1,searchInput:"",searchEntries:[],col:{id:"",code:"",userId:"",billDate:"",deliveryTime:"",ship:"",totalPrice:"",staffId:"",status:""},sortcol:{id:"",code:"",userId:"",billDate:"",deliveryTime:"",ship:"",totalPrice:"",staffId:"",status:""},check:null,getBillDetail:{}}},computed:{showInfo:function(){return s.uh.show(this.getCurrentEntries(),this.currentPage,this.currentEntries)},showPagination:function(){return s.uh.pagination(this.allPages,this.currentPage,2)},tableHeader:function(){return this.columns},tableData:function(){return this.filteredEntries}},created:function(){var t=this;d().then((function(e){console.log(e),t.entries=e,t.paginateData(t.entries)}))},methods:{paginateEntries:function(){this.searchInput.length>0?(this.searchEntries=s.uh.search(this.entries,this.searchInput),this.paginateData(this.searchEntries)):(this.searchEntries=[],this.paginateData(this.entries),this.col={id:"",code:"",userId:"",billDate:"",deliveryTime:"",ship:"",totalPrice:"",staffId:"",status:""})},paginateEvent:function(t){this.currentPage=t,this.paginateEntries()},searchEvent:function(){this.currentPage=1,this.paginateEntries()},paginateData:function(t){this.filteredEntries=s.uh.paginate(t,this.currentPage,this.currentEntries),this.allPages=s.uh.pages(t,this.currentEntries)},getCurrentEntries:function(){return this.searchInput.length<=0?this.entries:this.searchEntries},uniqColumData:function(t){return s.uh.unique(this.getCurrentEntries(),t)},filterByColumn:function(){var t=s.T4.removeBy(this.col,""),e=this.getCurrentEntries();Object.entries(t).length>=1&&(e=s.uh.filtered(this.getCurrentEntries(),t)),this.paginateData(e)},sortByColumn:function(t){this.col={id:"",code:"",userId:"",billDate:"",deliveryTime:"",ship:"",totalPrice:"",staffId:"",status:""};var e=this.getCurrentEntries(),n=this.sortcol[t];""===n?(this.sortcol[t]="asc",e=s.uh.sorted(this.getCurrentEntries(),t,"asc"),this.check=!1):"asc"===n?(this.sortcol[t]="desc",e=s.uh.sorted(this.getCurrentEntries(),t,"desc"),this.check=!0):"desc"===n&&(this.sortcol[t]="",this.check=null),this.paginateData(e)},openModal:function(t){var e=this;b()(".button-show-modal").click((function(){var t=b()(this).attr("id");b()("#modal-container").removeAttr("class").addClass(t),b()("body").addClass("modal-active")})),b()(".button-show-modal-out").click((function(){b()("#modal-container").addClass("out"),b()("body").removeClass("modal-active")})),h(t).then((function(t){t.listDetail.forEach((function(t){t.priceSell=e.toMoney(t.priceSell),t.totalPrice=e.toMoney(t.totalPrice)})),e.getBillDetail=t}))},formatDate:function(t){if(null==t)return"Chưa nhận";var e=c()(String(t)).format("DD/MM/YYYY HH:mm:ss");return e},toMoney:function(t){var e=new Intl.NumberFormat("it-IT",{style:"currency",currency:"VND"});return e.format(t)},checkStatus:function(t){return-2==t?'<button type="button" class="btn btn-danger">Hủy</button>':1==t?'<button type="button" class="btn btn-warning">Đang xác nhận</button>':2==t?'<button type="button" class="btn btn-info">Đang đóng hàng</button>':3==t?'<button type="button" class="btn btn-secondary">Đang chuyển hàng</button>':4==t?'<button type="button" class="btn btn-dark">Đang giao hàng</button>':5==t?'<button type="button" class="btn btn-success">Thành công</button>':void 0},checkStatusText:function(t){return-2==t?"Hủy":1==t?"Đang xác nhận":2==t?"Đang đóng hàng":3==t?"Đang chuyển hàng":4==t?"Đang giao hàng":5==t?"Thành công":void 0},ConfirmBill:function(t){this.$swal({title:"Bạn có chắc chắn Muốn Xác minh ?",text:"Đơn đặt hàng có mã: ".concat(t.code),type:"question",icon:"question",showCancelButton:!0,confirmButtonText:"Đồng ý",cancelButtonText:"Quay lại",closeOnConfirm:!1,closeOnCancel:!1}).then((function(e){e.isConfirmed&&(t.status=2,t.checkBill=!1,f(t.id).then((function(e){console.log(e),t.staffId=e})).catch((function(t){console.log(t)})))}))},CancelBill:function(t){this.$swal({title:"Bạn có chắc chắn Muốn Hủy ?",text:"Đơn đặt hàng có mã: ".concat(t.code),type:"question",icon:"question",showCancelButton:!0,confirmButtonText:"Đồng ý",cancelButtonText:"Quay lại",closeOnConfirm:!1,closeOnCancel:!1}).then((function(e){e.isConfirmed&&(t.status=-2,t.checkBill=!1,m(t.id).then((function(e){t.staffId=e.data})).catch((function(t){console.log(t)})))}))},updateStatus:function(t){t.status>=5||-2==t.status||1==t.status||this.$swal({title:"Bạn có chắc chắn Muốn thay đổi trạng thái ?",text:"Mã phiếu nhập: ".concat(t.code," || ").concat(this.checkStatusText(t.status)," => ").concat(this.checkStatusText(t.status+1)),type:"question",icon:"question",showCancelButton:!0,confirmButtonText:"Đồng ý",cancelButtonText:"Quay lại",closeOnConfirm:!1,closeOnCancel:!1}).then((function(e){e.isConfirmed&&(t.status=t.status+1,v(t.id).then((function(e){console.log(e),5==e.data.status&&(t.deliveryTime=e.data.deliveryTime)})).catch((function(t){console.log(t)})))}))},exportpdf:function(t){p(t.id).then((function(e){var n=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=n,a.setAttribute("download",t.code+".pdf"),document.body.appendChild(a),a.click()})).catch((function(t){console.log(t)}))}},mounted:function(){}},C=_,y=n(43736),w=(0,y.Z)(C,a,i,!1,null,"80a3cd1e",null),x=w.exports}}]);
//# sourceMappingURL=61-legacy.6d8d4349.js.map